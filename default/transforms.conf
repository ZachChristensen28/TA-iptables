# DO NOT EDIT THIS FILE!
# Please make all changes to files in $SPLUNK_HOME/etc/apps/TA_linux_iptables/local.
# To make changes, copy the section/stanza you want to change from $SPLUNK_HOME/etc/apps/TA_linux_iptables/default
# into ../local and edit there.

#====================================
# Sourcetyper
#====================================
[iptables_sourcetyper]
DEST_KEY = MetaData:Sourcetype
REGEX    = IN=[^\=]*OUT=
FORMAT   = sourcetype::linux:iptables

[iptables_ufw_sourcetyper]
DEST_KEY = MetaData:Sourcetype
REGEX    = \[UFW
FORMAT   = sourcetype::linux:iptables:ufw

[iptables_firewalld_sourcetyper]
DEST_KEY = MetaData:Sourcetype
REGEX    = \s(?:\S+_REJECT|\S+_DROP)\:\s+IN\=
FORMAT   = sourcetype::linux:iptables:firewalld

#====================================
# Lookups
#====================================
[iptables_icmp_codes_lookup]
filename = iptables_icmp_codes.csv

[iptables_action_lookup]
filename = iptables_action.csv
default_match = unknown
max_matches = 1
min_matches = 1

[iptables_transport_lookup]
filename = iptables_transport.csv
default_match = unknown
max_matches = 1
min_matches = 1

[iptables_frame_type_lookup]
filename = iptables_ethertypes.csv
default_match = unknown
max_matches = 1
min_matches = 1

#====================================
# Field Extractions
#====================================
[iptables_log_prefix]
REGEX = \*\*([^\*]*)\*
FORMAT = log_prefix::$1

[iptables_flags]
REGEX = RES=\S+\s((?:[A-Z]{3,}\s)+)
FORMAT = FLAGS::$1

[iptables_tcp_flag]
SOURCE_KEY = FLAGS
REGEX = (\S+)
FORMAT = tcp_flag::$1
MV_ADD = true

[iptables_mac]
REGEX = MAC=(\S{17}):(\S{17}):(\S{5})
FORMAT = dest_mac::$1 src_mac::$2 FRAME_TYPE::$3

[iptables_ufw_log_prefix]
REGEX = \[UFW\s([^\]]+)
FORMAT = log_prefix::$1

[iptables_firewalld_log_prefix]
REGEX = kernel: (\S+):? IN=
FORMAT = log_prefix::$1
